<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="head.Portfolio"></title>
    <link rel="stylesheet" href="/styles/style.css" />
    <link rel="stylesheet" href="portfolio.css" />
    <script type="module" src="/src/locales/translations.js"></script>
    <script
      src="https://kit.fontawesome.com/70455eaf31.js"
      crossorigin="anonymous"
      defer
    ></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Raleway:wght@100;300;400&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@100&display=swap"
      rel="stylesheet"
    />

    <!-----------------------------Components----------------------------->
    <script type="module" src="/src/components/MenuComponent.js"></script>
    <script type="module">
      import {
        initLanguage,
        saveLanguage,
      } from "/src/components/SaveLanguageInCookiesComponent.js";

      window.changeLang = (lang) => {
        saveLanguage(lang);
      };

      window.addEventListener("DOMContentLoaded", () => {
        initLanguage();
      });
    </script>
    <script type="module" src="/src/components/FooterComponent.js"></script>
  </head>
  <!-----------------------------Body----------------------------->
  <body>
    <!-----------------------------PopUp----------------------------->
    <div id="image-popup" class="popup">
      <span class="close">&times;</span>
      <img
        class="popup-content"
        id="popup-img"
        alt="Fullscreen image"
        loading="lazy"
      />
      <div class="popup-nav">
        <span id="prev" class="nav-arrow"
          ><i class="fa-solid fa-arrow-left"></i
        ></span>
        <span id="next" class="nav-arrow"
          ><i class="fa-solid fa-arrow-right"></i
        ></span>
      </div>
    </div>
    <!-----------------------------Header----------------------------->
    <div id="header">
      <div class="container">
        <!-----------------------------Menu----------------------------->
        <menu-component></menu-component>

        <!-----------------------------Header Text----------------------------->
        <div class="header-text">
          <h1 data-i18n="portfolio.title"></h1>
        </div>
      </div>
    </div>

    <!-----------------------------Portfolio----------------------------->
    <div id="portfolio">
      <div class="container">
        <h1 class="sub-title animate" data-i18n="portfolio.title"></h1>
        <div class="work-list" id="work-list"></div>
      </div>
    </div>
    <footer-component></footer-component>
  </body>

  <!-----------------------------Script----------------------------->
  <!-----------------------------Img Sizes----------------------------->
  <script>
    const imageNames = [
      "Castle.jpg",
      "SandDunes.jpg",
      "Shore.jpg",
      "ForeverForest.JPG",
      "BeachwavesLeft.JPG",
      "BlueWater.jpg",
      "BushesAndTrails.jpg",
      "EndlessForest.JPG",
      "JettyWithboats.jpg",
      "Lillypads.JPG",
      "MistyIsland.JPG",
      "Mountains.JPG",
      "ShoreWithBushes.jpg",
      "SomethingInTheBush.JPG",
      "SothernHills.JPG",
      "TurqoseWater.jpg",
    ];

    const container = document.getElementById("work-list");
    let visibleImagesCount = 9;

    function displayImages() {
      container.innerHTML = "";
      imageNames.forEach((name) => {
        const title = name
          .replace(/\.[^/.]+$/, "")
          .replace(/([A-Z])/g, " $1")
          .replace(/^\s/, "")
          .trim();

        const imagePath = `https://oscarbergstrom.netlify.app/src/assets/`;
        const html = `
            <div class="work animate">
                <img 
                    src="${imagePath}size250/${name}" 
                    alt="${title}" 
                    loading="lazy" 
                    data-name="${name}"
                    srcset="
                        ${imagePath}size250/${name} 300w, 
                        ${imagePath}size400/${name} 600w, 
                        ${imagePath}size800/${name} 1000w,
                        ${imagePath}sizeOriginal/${name} 2250w"
                    sizes="(max-width: 300px) 250px, (max-width: 600px) 400px, (max-width: 1000px) 800px, (max-width: 2250px) 2250px" >
                
            </div>
        `;
        container.innerHTML += html;
      });
    }

    displayImages();
  </script>
  <!-----------------------------Popup img----------------------------->
  <script>
    const popup = document.getElementById("image-popup");
    const popupImg = document.getElementById("popup-img");
    const closeBtn = document.querySelector(".popup .close");
    const nextBtn = document.getElementById("next");
    const prevBtn = document.getElementById("prev");

    function getAllImages() {
      return Array.from(document.querySelectorAll("#work-list img"));
    }
    let currentIndex = 0;

    function showImage(index) {
      const allImages = getAllImages();
      if (index < 0) index = allImages.length - 1;
      if (index >= allImages.length) index = 0;
      currentIndex = index;
      const img = allImages[currentIndex];
      const originalName = img.getAttribute("data-name");
      popupImg.src = `https://oscarbergstrom.netlify.app/src/assets/sizeOriginal/${originalName}`;
      popupImg.alt = img.alt;
      popup.style.display = "block";
    }

    document.addEventListener("click", function (e) {
      const allImages = getAllImages();
      const layer = e.target.closest(".work");
      if (layer) {
        const workImg = layer.closest(".work").querySelector("img");

        currentIndex = allImages.findIndex((img) => img.src === workImg.src);
        showImage(currentIndex);
      }
    });

    closeBtn.addEventListener("click", () => (popup.style.display = "none"));

    popup.addEventListener("click", (e) => {
      if (e.target === popup) popup.style.display = "none";
    });

    nextBtn.addEventListener("click", () => showImage(currentIndex + 1));
    prevBtn.addEventListener("click", () => showImage(currentIndex - 1));

    document.addEventListener("keydown", (e) => {
      if (popup.style.display === "block") {
        if (e.key === "ArrowRight") showImage(currentIndex + 1);
        if (e.key === "ArrowLeft") showImage(currentIndex - 1);
        if (e.key === "Escape") popup.style.display = "none";
      }
    });
  </script>
</html>
